date 10/25/18
Contents: one executable: "Lab03-01.exe"

Format:

x) Question.

- Tool used
# answer to question

information extracted

---------------------------------------------------------

1) imports and strings?
    - PEstudio
        # 1 import from kernel32.dll so this looks packed
        # Strings reveal windows registry locations, www. link, additional executable, CONNECT %s..HTTP thing, additional imports (advapi32, etc.) that aren't mentioned further proving it's packed, winVMX32,
2) Host indicators?
    # derived from the strings above: the .exe files
3) network indicators  
    # derived from the strings above: www. link, CONNECT*,  


Note: Since I started over, I was unaware we moved into dynamic analysis and I only used static analysis. So I'm going to go back and utilize process monitor to see if I can derive any additional information.

- Process Explorer
    # Here we find the .exe creates a persistent and visible process. We view the .DLL it utilizes and can see a number of imports that were previously missed.
- ApateDNS/Wireshark/netcat (listening on port 80,443), process monitor
    # Apate & Wireshark & ProcMon on victim, netcat & Wireshark on seperate machine
    # ncat -l 80, 443
    # MAKE SURE BOTH FIREWALLS ARE OFF
    # MAKE SURE THEY CAN CONECT TO EACH OTHER
        # I used vmware's DHCP service: Edit > Virutal Network Editor > VMnet<number> > Host-Ony > UNCHECK "Connect a host virtual adapter to this network", CHECK "use local dhcp service to distribute IP address to VMs" > reset network settings on both hosts and test connection between the two

    # ApateDNS showed two 30 second connections to "www.practicalmalwareanalysis.com" and two additional with one minute intervals and continues trying to connect to ApateDNS.
    # ncat - received no connections on either victim host or separate host. (Most likely improper setup)
    # Wireshark (No filters) - only see one packet - source address: my ip, Dest. address: 255.255.255.255 (broadcast), source port: 1028, dest. port: 1947 (sentinelsrm), 40 bytes of data.
    # procMon (have certain filters to reduce noise and capture main part) - 4 events: 3 regsetvalue: 1 by Lab03-01.exe: (HKLM\SOFTWARE\Microsoft\Cryptography\RNG\Seed), 2 by explorer.exe process: (HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\UserAssist\{75048700-EF1F-11D0-9888-006097DEACF9}\Count\HRZR_EHACNGU), (HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\UserAssist\{75048700-EF1F-11D0-9888-006097DEACF9}\Count\HRZR_EHACNGU:P:\Qbphzragf naq Frggvatf\Nqzvavfgengbe\Qrfxgbc\Cenpgvpny Znyjner Nanylfvf Ynof\OvanelPbyyrpgvba\Puncgre_3Y\Yno03-01.rkr) <~~ looks like ADS because of colon (:)
        # Other is writefile: (C:\WINDOWS\Prefetch\LAB03-01.EXE-2FD39F59.pf) by process "svchost.exe".

Conclusion: Don't understand much more except for ApateDNS. It keeps attempting to connect to the link. Unfortunately, I was unable to properly setup ncat but hopefully the answers will teach me how.
            Procmon provided valuable host-based signatures to watch for but don't really understand the significance of the referenced hives. The wireshark piece provided only a single packet with the data section in ASCII not representing anything readable.
            
Answer: